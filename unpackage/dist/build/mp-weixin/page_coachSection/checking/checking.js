(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["page_coachSection/checking/checking"],{"2aea":function(e,t,n){"use strict";(function(e,t){var o=n("4ea4");n("106e");o(n("66fd"));var i=o(n("87a0"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(i.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},"38d9":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){}));var o=function(){var e=this.$createElement;this._self._c;this._isMounted||(this.e0=function(e){return this.$win.back()})},i=[]},"3c14":function(e,t,n){"use strict";n.r(t);var o=n("5402"),i=n.n(o);for(var c in o)["default"].indexOf(c)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(c);t["default"]=i.a},5402:function(e,t,n){"use strict";(function(e){var o=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n("2eee")),c=o(n("c973")),u=o(n("9523")),a=n("26cb"),r=o(n("c230")),s=o(n("3604"));function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){(0,u.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d=new r.default({key:"RBNBZ-5QRKD-ZZD42-PEYZU-25XGV-56BIK"}),h={data:function(){return{cdn:this.$conf.CDN_HOST,path:this.$conf.BASE_HOST,imageSrc:null,position:"点击获取地址信息",latitude:null,longitude:null,gTime:null,checkTime:null,venue:null,siteId:""}},computed:f({},(0,a.mapState)({code:function(e){return e.coachSection.checkCode},time:function(e){return e.coachSection.time},address:function(e){return e.coachSection.address},venueList:function(e){return e.venue.venueListById}})),methods:f(f({},(0,a.mapActions)({check_fun:"coachSection/check",getVenueListById_fun:"venue/getVenueListById"})),{},{getAuth:function(){var t=this;e.authorize({scope:"scope.userLocation",success:function(){t.getLocation()},fail:function(){t.$win.nlog("取消授权")}})},getLocation:function(){var t=this;e.getLocation({type:"gcj02",success:function(e){console.log("当前位置的经度："+e.longitude),console.log("当前位置的纬度："+e.latitude),t.latitude=e.latitude,t.longitude=e.longitude;var n=e.latitude,o=e.longitude;d.reverseGeocoder({location:n?"".concat(n,",").concat(o):"",sig:"gfOfdUfdyWmTa5FMeFl6AXhXKEUSSYVo",success:function(e){console.log("这就是要获取的当前所在城市的相关信息",e),t.position=e.result.address},fail:function(e){console.log("获取城市失败")}})}})},bindPickerChange:function(e){this.venue=this.venueList[e.detail.value].siteName,this.siteId=this.venueList[e.detail.value].id},takePhoto:function(){var t=this;e.authorize({scope:"scope.camera",success:function(){e.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["camera"],success:function(e){console.log(e),t.$win.nlog("图片选择成功"),t.imageSrc=e.tempFilePaths[0]},fail:function(e){t.$win.nlog(e||"错误")}})},fail:function(){t.$win.nlog("取消授权")}})},upLoadPhoto:function(){var t=this;return(0,c.default)(i.default.mark((function n(){return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.uploadFile({url:t.path+"/app/uploadFiles/upload",fileType:"image",filePath:t.imageSrc,name:"file",header:{token:t.$db.getSync("token")},data:{postion:t.position,userId:t.$db.getSync("userId")},success:function(e){console.log(e),200==e.statusCode?(t.$win.nlog("上传成功"),console.log("上传成功"),t.check(e.data)):(console.log("上传失败"),t.$win.nlog("上传失败"))},fail:function(e){console.log(e,"错误")}});case 1:case"end":return n.stop()}}),n)})))()},getTime:function(){var e=(0,s.default)().format("YYYY"),t=(0,s.default)().format("M"),n=(0,s.default)().format("DD"),o=(0,s.default)().format("d"),i=(0,s.default)().format("HH"),c=(0,s.default)().format("mm"),u=(0,s.default)().format("ss"),a=e+"年"+t+"月"+n+"日"+["周日","周一","周二","周三","周四","周五","周六"][o]+i+":"+c+":"+u;this.checkTime=a},check:function(e){var t=this;return(0,c.default)(i.default.mark((function n(){var o;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o={userId:t.$db.getSync("userId"),registerTime:t.checkTime,longitude:t.longitude+"",latitude:t.latitude+"",siteName:t.position,venue:t.venue,id:t.siteId,fileName:e},n.next=3,t.check_fun(o);case 3:n.sent;case 4:case"end":return n.stop()}}),n)})))()},getVenueList:function(){var e=this;return(0,c.default)(i.default.mark((function t(){var n;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={userId:e.$db.getSync("userId")},t.next=3,e.getVenueListById_fun(n);case 3:case"end":return t.stop()}}),t)})))()}}),onShow:function(){var e=this;this.getVenueList(),this.getTime(),this.gTime=setInterval((function(){e.getTime()}),1e3)},onHide:function(){},onUnload:function(){clearInterval(this.gTime)},onLoad:function(){}};t.default=h}).call(this,n("543d")["default"])},"5c52":function(e,t,n){},"87a0":function(e,t,n){"use strict";n.r(t);var o=n("38d9"),i=n("3c14");for(var c in i)["default"].indexOf(c)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(c);n("9b02");var u=n("f0c5"),a=Object(u["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],void 0);t["default"]=a.exports},"9b02":function(e,t,n){"use strict";var o=n("5c52"),i=n.n(o);i.a}},[["2aea","common/runtime","common/vendor"]]]);