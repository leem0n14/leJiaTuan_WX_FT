(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["page_indexOperate/bookingPractice/bookingPractice"],{3193:function(e,t,n){"use strict";n.r(t);var i=n("8f12"),u=n.n(i);for(var r in i)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=u.a},"53d4":function(e,t,n){"use strict";var i=n("c12c"),u=n.n(i);u.a},"8f12":function(e,t,n){"use strict";(function(e){var i=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=i(n("2eee")),r=i(n("278c")),a=i(n("c973")),o=i(n("9523")),s=n("26cb"),c=i(n("3604"));function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,o.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={data:function(){return{cdn:this.$conf.CDN_HOST,isShuttle:!1,receive:1,formattedDate:null,formattedDateEnd:null,isSub:!1,type:"请选择驾照类型",typeName:["c1(手动档)","c2(自动挡)","c3(小车)","A2(货车)","B2(货车)","A1(客车)","A3(客车)","B1(客车)","D(摩托车)","E(摩托车)","F(摩托车)"],pTime:"请选择练车时间",sTime:"请选择接送时间",pDate:"请选择练车日期",course:"",site:"",addTime:null,practiceTime:["7月28日14:00到17:00","7月29日14:00到17:00","7月30日14:00到17:00","7月31日14:00到17:00"],shuttleTime:["7月28日14:00","7月29日14:00"],courseType:["科目二","科目三"],name:null,phone:null,jiesongStatu:null,carTime:null,mpTime:null,address:null,addName:null,addressLongitude:null,addressLatitude:null}},methods:l(l({initChange:function(){this.name=this.name1,this.phone=this.phone1}},(0,s.mapActions)({toBooking_fun:"booking/toPractice",getPTime_fun:"booking/getPTime",getSite_fun:"booking/getSite",getPersonMsg_fun:"user/getPerson",getRule_fun:"booking/getBookingRule"})),{},{chooseDate:function(e){this.pDate=e.detail.value,this.addTime=e.detail.value},changeType:function(e){this.type=this.typeName[e.detail.value]},chooseTime:function(e){this.isShuttle=!1,this.address="",this.addName="",this.addressLatitude="",this.addressLongitude="",this.pTime=this.timeList[e.detail.value].carTime,this.receive=this.timeList[e.detail.value].receive},chooseCourse:function(e){this.course=this.courseType[e.detail.value]},choosesite:function(e){this.site=this.sites[e.detail.value].siteName},chooseShuttleTime:function(e){this.sTime=this.shuttleTime[e.detail.value]},shuttle:function(){this.isShuttle=!this.isShuttle},getSite:function(){var e=this;return(0,a.default)(u.default.mark((function t(){var n;return u.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={userId:e.$db.getSync("userId")},t.next=3,e.getSite_fun(n);case 3:t.sent;case 4:case"end":return t.stop()}}),t)})))()},toBooking:function(){var e=this;return(0,a.default)(u.default.mark((function t(){var n,i;return u.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=0,e.isShuttle&&(n=1),!(e.name&&e.phone&&"请选择驾照类型"!=e.type&&"请选择练车科目"!=e.course&&"请选择练车时间"!=e.pTime&&e.valid)){t.next=12;break}if(!(e.phone.length<11)){t.next=6;break}return e.$win.nlog("手机号不足11位"),t.abrupt("return");case 6:return i={userId:e.$db.getSync("userId"),name:e.name,phone:e.phone,carType:e.type,object:e.course,jiesongStatu:n,carTime:e.pTime,mptime:e.sTime,address:e.address,addName:e.addName,longitude:e.addressLongitude,latitude:e.addressLatitude,site:e.site,addTime:e.addTime},t.next=9,e.toBooking_fun(i);case 9:t.sent,t.next=14;break;case 12:return e.$win.nlog("请填写完整信息"),t.abrupt("return");case 14:case"end":return t.stop()}}),t)})))()},chooseAddress:function(){var t=this;e.getLocation({type:"gcj02",success:function(n){var i=n.latitude,u=n.longitude;e.chooseLocation({latitude:i,longitude:u,success:function(e){console.log(e),t.address=e.address,t.addName=e.name,t.addressLatitude=e.latitude,t.addressLongitude=e.longitude}})}})},timeToMinutes:function(e){var t=e.split(":"),n=(0,r.default)(t,2),i=n[0],u=n[1];return 60*parseInt(i,10)+parseInt(u,10)},getTime:function(){var e=this;return(0,a.default)(u.default.mark((function t(){var n;return u.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={},t.next=3,e.getPTime_fun(n);case 3:t.sent;case 4:case"end":return t.stop()}}),t)})))()},getRule:function(){var e=this;return(0,a.default)(u.default.mark((function t(){return u.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getRule_fun({way:1}).then((function(){var t=(new Date).getTime(),n=new Date,i=n.getHours(),u=n.getMinutes(),r=60*i+u,a=t+24*e.bookingRule.days*60*60*1e3,o=e.timeToMinutes(e.bookingRule.endTime);console.log(o),r>=o?(a+=864e5,e.formattedDate=(0,c.default)(a).format("YYYY-MM-DD"),console.log("cc")):e.formattedDate=(0,c.default)(a).format("YYYY-MM-DD"),console.log(e.formattedDate,"this.formattedDate")}));case 2:case"end":return t.stop()}}),t)})))()}}),computed:l(l({},(0,s.mapState)({pRes:function(e){return e.booking.pRes},timeList:function(e){return e.booking.timeList},sites:function(e){return e.booking.site},personMsg:function(e){return e.user.getPersonRes},name1:function(e){return e.user.name},phone1:function(e){return e.user.phone},bookingRule:function(e){return e.booking.bookingRule}})),{},{valid:function(){return this.name&&this.phone&&"请选择驾照类型"!=this.type&&""!=this.course&&""!=this.site&&"请选择练车时间"!=this.pTime&&"请选择练车日期"!=this.pDate&&(!this.isShuttle||this.addName)}}),onShow:function(){this.getTime(),this.getSite(),this.initChange()},mounted:function(){var e=(new Date).getTime();this.formattedDate=(0,c.default)(e).format("YYYY-MM-DD"),this.getRule()}};t.default=f}).call(this,n("543d")["default"])},b3fa:function(e,t,n){"use strict";(function(e,t){var i=n("4ea4");n("106e");i(n("66fd"));var u=i(n("eb68"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(u.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},b7d3:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){}));var i=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){return e.$win.nlog(0===e.receive?"该时间段不可接送":"")})},u=[]},c12c:function(e,t,n){},eb68:function(e,t,n){"use strict";n.r(t);var i=n("b7d3"),u=n("3193");for(var r in u)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return u[e]}))}(r);n("53d4");var a=n("f0c5"),o=Object(a["a"])(u["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],void 0);t["default"]=o.exports}},[["b3fa","common/runtime","common/vendor"]]]);