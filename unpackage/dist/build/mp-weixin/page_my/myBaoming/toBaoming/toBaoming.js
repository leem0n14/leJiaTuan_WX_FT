(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["page_my/myBaoming/toBaoming/toBaoming"],{1748:function(t,e,a){"use strict";(function(t){var n=a("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n(a("2eee")),r=n(a("c973")),c=n(a("9523")),i=a("26cb");function s(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function u(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?s(Object(a),!0).forEach((function(e){(0,c.default)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var d={data:function(){return{cdn:this.$conf.CDN_HOST,path:this.$conf.BASE_HOST,dataForm:{id:null,stuName:"",stuSex:"",cardId:"",cardAd:"",stuPhone:"",school:"",coachId:"",coachName:"",cardFront:"",cardBack:"",tijianbiao:"",photo:"",statu:""},pageIndex:1,pageSize:10,sexList:[{name:"男",checked:!1},{name:"女",checked:!1}]}},computed:u(u({},(0,i.mapState)({schoolList:function(t){return t.venue.schoolList},coachList:function(t){return t.coach.coachList}})),{},{valid:function(){var t=this.dataForm.stuName&&this.dataForm.stuSex&&this.dataForm.cardId&&this.dataForm.cardAd&&this.dataForm.school&&this.dataForm.stuPhone,e=this.dataForm.cardBack&&this.dataForm.cardFront&&this.dataForm.photo;return t&&e}}),watch:{"dataForm.school":function(t){this.getCoach(t)},"dataForm.stuSex":function(t){for(var e=0;e<this.sexList.length;e++)this.sexList[e].checked=!1;for(var a=0;a<this.sexList.length;a++)t===this.sexList[a].name&&(this.sexList[a].checked=!0)}},methods:u(u({},(0,i.mapActions)({getSchoolList_fun:"venue/getSchoolList",sub_fun:"my/subBaoming",getCoachList_fun:"coach/getCoachBySchool"})),{},{getCoach:function(t){var e=this;return(0,r.default)(o.default.mark((function a(){var n;return o.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={school:t},a.next=3,e.getCoachList_fun(n);case 3:a.sent;case 4:case"end":return a.stop()}}),a)})))()},getSchool:function(){var t=this;return(0,r.default)(o.default.mark((function e(){var a;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={},e.next=3,t.getSchoolList_fun(a);case 3:e.sent;case 4:case"end":return e.stop()}}),e)})))()},handleSchool:function(t){this.dataForm.school=this.schoolList[t.detail.value].schoolName},handleCoach:function(t){this.dataForm.coachId=this.coachList[t.detail.value].coachId,this.dataForm.coachName=this.coachList[t.detail.value].coachName},handleSex:function(t){this.dataForm.stuSex=t.detail.value},upload:function(e){var a=this,n=e;t.chooseImage({count:1,success:function(e){var o=e.tempFilePaths;t.uploadFile({url:a.path+"/app/uploadFiles/photoUpload",filePath:o[0],name:"file",header:{token:a.$db.getSync("token")},formData:{where:"student"},data:{userId:a.$db.getSync("userId")},success:function(t){if(console.log(t),200===t.statusCode)switch(a.$win.nlog("上传成功"),n){case 1:a.dataForm.cardFront=JSON.parse(t.data).fileName;break;case 2:a.dataForm.cardBack=JSON.parse(t.data).fileName;break;case 3:a.dataForm.tijianbiao=JSON.parse(t.data).fileName;break;case 4:a.dataForm.photo=JSON.parse(t.data).fileName;break}else console.log("上传失败")},fail:function(t){console.log(t,"错误")}})}})},sub:function(){var t=this;return(0,r.default)(o.default.mark((function e(){var a;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.valid){e.next=3;break}return t.$win.nlog("请填写完整信息"),e.abrupt("return");case 3:if(/^[\u4e00-\u9fa5]{2,10}$/.test(t.dataForm.stuName)){e.next=6;break}return t.$win.nlog("名字必须为2~10个中文字符"),e.abrupt("return");case 6:if(/^1[3-9]\d{9}$/.test(t.dataForm.stuPhone)){e.next=9;break}return t.$win.nlog("请填写正确的手机号码"),e.abrupt("return");case 9:return a=u(u({},t.dataForm),{},{id:parseInt(t.dataForm.id),coachId:t.dataForm.coachId?t.dataForm.coachId:0}),e.next=12,t.sub_fun(a);case 12:e.sent;case 13:case"end":return e.stop()}}),e)})))()}}),onShow:function(){this.getSchool()},onLoad:function(t){var e=this;Object.keys(t).forEach((function(a){""!=t[a]&&"null"!=t[a]&&null!=t[a]&&void 0!=t[a]&&"undefined"!=t[a]&&(e.dataForm[a]=t[a])}))},onReachBottom:function(){}};e.default=d}).call(this,a("543d")["default"])},"41bd":function(t,e,a){},"72e2":function(t,e,a){"use strict";var n=a("41bd"),o=a.n(n);o.a},a4f3:function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){}));var n=function(){var t=this.$createElement;this._self._c},o=[]},ae15:function(t,e,a){"use strict";a.r(e);var n=a("a4f3"),o=a("e166");for(var r in o)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return o[t]}))}(r);a("72e2");var c=a("f0c5"),i=Object(c["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);e["default"]=i.exports},cb37:function(t,e,a){"use strict";(function(t,e){var n=a("4ea4");a("106e");n(a("66fd"));var o=n(a("ae15"));t.__webpack_require_UNI_MP_PLUGIN__=a,e(o.default)}).call(this,a("bc2e")["default"],a("543d")["createPage"])},e166:function(t,e,a){"use strict";a.r(e);var n=a("1748"),o=a.n(n);for(var r in n)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(r);e["default"]=o.a}},[["cb37","common/runtime","common/vendor"]]]);